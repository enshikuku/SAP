<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This Event</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon">
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const navCheck = document.querySelector('#nav-check')
            const navLinks = document.querySelector('.nav-links')

            const navLinksArray = document.querySelectorAll('.nav-links a')
            navLinksArray.forEach(link => {
                link.addEventListener('click', function() {
                    navCheck.checked = false
                })
            })

            navCheck.addEventListener('change', function() {
                if (navCheck.checked) {
                    navLinks.style.height = 'calc(100vh - 50px)'
                    navLinks.style.overflowY = 'auto'
                } else {
                    navLinks.style.height = '0'
                }
            })
        })
    </script>
</head>
<body>
    <header>
        <div class="nav">
            <div class="nav-logo-links">
                <div class="nav-header">
                    <div class="nav-title"><a href="/"><img src="assets/images/logo.png" alt=""></a></div>
                </div>
                <div class="nav-links">
                    <a onclick="closeNav()" href="/#home">Home</a>
                    <a onclick="closeNav()" href="/#about">About</a>
                    <a onclick="closeNav()" href="/#agenda">Agenda</a>
                    <a onclick="closeNav()" href="/#speakers">Speakers</a>
                    <a onclick="closeNav()" href="/#venue">Venue</a>
                    <script>
                        function closeNav() {
                            const navLinks = document.querySelector('.nav-links')
                            navLinks.style.height = '0'
                        }
                    </script>
                </div>
            </div>
            <div class="nav-logo-links">
                <button id="showButton" class="showButton"><img src="assets/images/chat.png" alt=""></button>
                <section id="contactSection" class="contact-section">
                    <h2>Contact Us</h2>
                    <p>For inquiries, contact us at:</p>
                    <p>Email: <a href="mailto:info@example.com">info@example.com</a></p>
                    <p>Phone: <a href="tel:+123456789">+1 234 567 89</a></p>
                </section>
                <script>
                    document.getElementById('showButton').addEventListener('click', function() {
                    var contactSection = document.getElementById('contactSection');
                    if (contactSection.style.display === 'none' || contactSection.style.display === '') {
                        contactSection.style.display = 'block';
                    } else {
                        contactSection.style.display = 'none'; 
                    }
                    });
                </script>
                <div class="nav-btn">
                    <label for="nav-check"><img src="assets/images/nav.png" alt=""></label>
                </div>
                <input type="checkbox" id="nav-check">
            </div>
        </div>
    </header>
    <div class="registration__list">
        <% if (registrations.length > 0) { %>
        <div class="regs__title">
            <h1>Registrations</h1> 
            <button id="export-btn">Export to Excel</button>
        </div>
        <table id="registrations-table">
            <thead>
                <tr>
                    <% for (let key in registrations[0]) { %>
                        <th><%= key %></th>
                    <% } %>
                </tr>
            </thead>
            <tbody>
                <% registrations.forEach(function(registration) { %>
                    <tr>
                        <% for (let key in registration) { %>
                            <td><%= registration[key] %></td>
                        <% } %>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    
        <script>
            document.getElementById('export-btn').addEventListener('click', () => {
                const table = document.getElementById('registrations-table');
                const rows = Array.from(table.querySelectorAll('tr')).map(row => 
                    Array.from(row.querySelectorAll('th, td')).map(cell => cell.innerText).join(',')
                ).join('\n');
    
                const blob = new Blob([rows], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'registrations.csv';
                a.click();
                URL.revokeObjectURL(url);
            });
        </script>
        <% } else { %>
            <p>No registrations found.</p>
        <% } %>
    </div>
        
    <footer>
        <div class="socials">
            Share & Follow 
            <a href="#"><img src="assets/images/facebook.png" alt=""></a>
            <a href="#"><img src="assets/images/x.png" alt=""></a>
            <a href="#"><img src="assets/images/ig.png" alt=""></a>
            <a href="#"><img src="assets/images/linkedin.png" alt=""></a>
        </div>
    </footer>
</body>
</html>
